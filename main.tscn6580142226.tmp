[gd_scene load_steps=13 format=3 uid="uid://bi1ruv5c6mhjn"]

[ext_resource type="MeshLibrary" uid="uid://b6fwsq8c3pcvc" path="res://mesh_library.tres" id="1_ig7tw"]
[ext_resource type="Script" uid="uid://dscb6l7gvxvp4" path="res://fez_grid_manager.gd" id="2_0xm2m"]
[ext_resource type="Script" uid="uid://jge5op1hytxa" path="res://DirectionalView.gd" id="4_1bvp3"]
[ext_resource type="Texture2D" uid="uid://cah2du3y06utc" path="res://icon.svg" id="4_lquwl"]

[sub_resource type="PhysicalSkyMaterial" id="PhysicalSkyMaterial_1bvp3"]

[sub_resource type="Sky" id="Sky_lquwl"]
sky_material = SubResource("PhysicalSkyMaterial_1bvp3")

[sub_resource type="Environment" id="Environment_0xm2m"]
background_mode = 2
sky = SubResource("Sky_lquwl")
sky_rotation = Vector3(0, 2.87979, 0)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_7mycd"]
albedo_texture = ExtResource("4_lquwl")

[sub_resource type="QuadMesh" id="QuadMesh_h2yge"]

[sub_resource type="GDScript" id="GDScript_h2yge"]
script/source = "extends CharacterBody2D


const SPEED = 300.0
const JUMP_VELOCITY = -650.0

func _ready() -> void:
	print(\"front: \", get_world_2d().space)
	
func _physics_process(delta: float) -> void:
	# Add the gravity.
	if not is_on_floor():
		velocity += get_gravity() * delta

	# Handle jump.
	if Input.is_action_just_pressed(\"ui_accept\") and is_on_floor():
		velocity.y = JUMP_VELOCITY

	# Get the input direction and handle the movement/deceleration.
	# As good practice, you should replace UI actions with custom gameplay actions.
	var direction := Input.get_axis(\"ui_left\", \"ui_right\")
	if direction:
		velocity.x = direction * SPEED
	else:
		velocity.x = move_toward(velocity.x, 0, SPEED)

	move_and_slide()
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_h2yge"]
size = Vector2(50, 50)

[sub_resource type="QuadMesh" id="QuadMesh_1bvp3"]

[node name="Node3D" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_0xm2m")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.58592, 0.810369, 0, -0.810369, 0.58592, 10.7491, 8.56544, 9.87242)

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.45439, 21.6851, 24.4563)
projection = 1
size = 20.0

[node name="Buildings" type="GridMap" parent="."]
mesh_library = ExtResource("1_ig7tw")
collision_layer = 0
collision_mask = 0
data = {
"cells": PackedInt32Array(0, 1, 655370, 0, 0, 655370, 0, 65535, 655370, 0, 65534, 655370, 1, 65534, 655370, 1, 65535, 655370, 1, 0, 655370, 1, 1, 655370, 65535, 65534, 10, 65535, 65535, 655370, 65535, 1, 1048586, 65535, 0, 1048586, 65534, 65534, 1441802, 65534, 65535, 1441802, 65534, 0, 1441802, 65534, 1, 1441802, 131070, 1, 1441802, 131071, 1, 1441802, 131070, 65534, 1441802, 131071, 65534, 1441802, 65536, 65534, 1441802, 65537, 65534, 1441802, 131070, 65535, 1441802, 131071, 65535, 1441802, 65536, 65535, 1441802, 65537, 65535, 1441802, 131070, 0, 1441802, 131071, 0, 1441802, 65536, 0, 1441802, 65537, 0, 1441802, 65536, 1, 1441802, 65537, 1, 1441802, 196606, 1, 1441802, 196607, 1, 1441802, 131072, 1, 1441802, 196606, 65534, 1441802, 196607, 65534, 1441802, 131072, 65534, 1441802, 131073, 65534, 1441802, 196606, 65535, 1441802, 196607, 65535, 1441802, 131072, 65535, 1441802, 131073, 65535, 1441802, 131073, 0, 1441802, 131073, 1, 1441802, 196606, 0, 1441802, 196607, 0, 1441802, 131072, 0, 1441802, 262142, 65534, 1441802, 262143, 65534, 1441802, 196608, 65534, 1441802, 196609, 65534, 1441802, 262142, 65535, 1441802, 262143, 65535, 1441802, 196608, 65535, 1441802, 196609, 65535, 1441802, 262142, 0, 1441802, 262143, 0, 1441802, 196608, 0, 1441802, 196609, 0, 1441802, 262142, 1, 1441802, 262143, 1, 1441802, 196608, 1, 1441802, 196609, 1, 1441802, 327678, 65534, 1441802, 327679, 65534, 1441802, 262144, 65534, 1441802, 262145, 65534, 1441802, 327678, 65535, 1441802, 327679, 65535, 1441802, 262144, 65535, 1441802, 262145, 65535, 1441802, 327678, 0, 1441802, 327679, 0, 1441802, 262144, 0, 1441802, 262145, 0, 1441802, 327678, 1, 1441802, 327679, 1, 1441802, 262144, 1, 1441802, 262145, 1, 1441802, 393214, 65534, 1441802, 393215, 65534, 1441802, 327680, 65534, 1441802, 327681, 65534, 1441802, 393214, 65535, 1441802, 393215, 65535, 1441802, 327680, 65535, 1441802, 327681, 65535, 1441802, 393214, 0, 1441802, 393215, 0, 1441802, 327680, 0, 1441802, 327681, 0, 1441802, 393214, 1, 1441802, 393215, 1, 1441802, 327680, 1, 1441802, 327681, 1, 1441802, 458750, 65534, 1441802, 458751, 65534, 1441802, 393216, 65534, 1441802, 393217, 65534, 1441802, 458750, 65535, 1441802, 458751, 65535, 1441802, 393216, 65535, 1441802, 393217, 65535, 1441802, 458750, 0, 1441802, 458751, 0, 1441802, 393216, 0, 1441802, 393217, 0, 1441802, 458750, 1, 1441802, 458751, 1, 1441802, 393216, 1, 1441802, 393217, 1, 1441802, 524286, 65534, 1441802, 524287, 65534, 1441802, 458752, 65534, 1441802, 458753, 65534, 1441802, 524286, 65535, 1441802, 524287, 65535, 1441802, 458752, 65535, 1441802, 458753, 65535, 1441802, 524286, 0, 1441802, 524287, 0, 1441802, 458752, 0, 1441802, 458753, 0, 1441802, 524286, 1, 1441802, 524287, 1, 1441802, 458752, 1, 1441802, 458753, 1, 1441802, 589822, 65534, 1441802, 589823, 65534, 1441802, 524288, 65534, 1441802, 524289, 65534, 1441802, 524289, 65535, 1441802, 589822, 65535, 1441802, 589823, 65535, 1441802, 524288, 65535, 1441802, 589822, 0, 1441802, 589823, 0, 1441802, 524288, 0, 1441802, 524289, 0, 1441802, 589822, 1, 1441802, 589823, 1, 1441802, 524288, 1, 1441802, 524289, 1, 1441802, 655358, 65534, 1441802, 655359, 65534, 1441802, 589824, 65534, 1441802, 589825, 65534, 1441802, 655358, 65535, 1441802, 655359, 65535, 1441802, 589824, 65535, 1441802, 589825, 65535, 1441802, 655358, 0, 1441802, 655359, 0, 1441802, 589824, 0, 1441802, 589825, 0, 1441802, 655358, 1, 1441802, 655359, 1, 1441802, 589824, 1, 1441802, 589825, 1, 1441802, 720894, 65534, 1441802, 720895, 65534, 1441802, 655360, 65534, 1441802, 655361, 65534, 1441802, 720894, 65535, 1441802, 720895, 65535, 1441802, 655360, 65535, 1441802, 655361, 65535, 1441802, 720894, 0, 1441802, 720895, 0, 1441802, 655360, 0, 1441802, 655361, 0, 1441802, 720894, 1, 1441802, 720895, 1, 1441802, 655360, 1, 1441802, 655361, 1, 1441802, 786430, 65534, 1441802, 786431, 65534, 1441802, 720896, 65534, 1441802, 720897, 65534, 1441802, 786430, 65535, 1441802, 786431, 65535, 1441802, 720896, 65535, 1441802, 720897, 65535, 1441802, 786430, 0, 1441802, 786431, 0, 1441802, 720896, 0, 1441802, 720897, 0, 1441802, 786430, 1, 1441802, 786431, 1, 1441802, 720896, 1, 1441802, 720897, 1, 1441802)
}
metadata/_editor_floor_ = Vector3(0, 11, 0)

[node name="Bodies" type="GridMap" parent="."]
mesh_library = ExtResource("1_ig7tw")
collision_mask = 0
data = {
"cells": PackedInt32Array(262142, 2, 9, 262143, 2, 9, 196608, 2, 9, 196609, 2, 9, 196610, 2, 9, 196610, 1, 9, 196610, 0, 9, 196610, 65535, 9, 196610, 65534, 9, 196610, 65533, 9, 262141, 2, 9, 262141, 1, 9, 262141, 0, 9, 262141, 65535, 9, 262141, 65534, 9, 262141, 65533, 9, 262142, 65533, 9, 196609, 65533, 196617, 196608, 65533, 196617, 262143, 65533, 196617, 196613, 4, 196617, 196614, 4, 196617, 196614, 5, 196617, 196613, 5, 196617, 196613, 6, 196617, 196614, 6, 196617, 196615, 4, 131081, 196615, 5, 131081, 196615, 6, 131081, 262150, 5, 131075, 524286, 2, 1114126, 458753, 2, 1114126, 458752, 2, 1114126, 458754, 2, 1114126, 524285, 2, 1114126, 524284, 2, 1114126, 524283, 2, 1114126, 524282, 2, 1114126, 524282, 0, 1114126, 524282, 1, 1114126, 524282, 65535, 1114126, 524282, 65533, 1114126, 524282, 65534, 1114126, 524283, 65533, 1114126, 524284, 65533, 1114126, 524285, 65533, 1114126, 524286, 65533, 1114126, 458753, 65533, 1114126, 458754, 65533, 1114126, 458754, 65534, 1114126, 458754, 65535, 1114126, 458754, 0, 1114126, 458754, 1, 1114126, 524285, 1, 14, 524284, 1, 14, 524283, 1, 14, 524285, 0, 14, 524284, 0, 14, 524283, 0, 14, 524285, 65535, 14, 524284, 65535, 14, 524283, 65535, 14, 524285, 65534, 14, 524284, 65534, 14, 524283, 65534, 14, 458754, 65532, 14, 458753, 65532, 14, 524285, 65532, 14, 524284, 65532, 14, 524283, 65532, 14, 524282, 65532, 14, 524286, 65532, 14, 524287, 2, 1114126, 655359, 2, 786446)
}
metadata/_editor_floor_ = Vector3(0, 9, 0)

[node name="Manager" type="Node" parent="." node_paths=PackedStringArray("viewport_front", "viewport_back", "viewport_left", "viewport_right", "grid_building", "grid_body", "character", "mesh_instance", "camera")]
script = ExtResource("2_0xm2m")
viewport_front = NodePath("../CharacterMesh/Front")
viewport_back = NodePath("../CharacterMesh/Back")
viewport_left = NodePath("../CharacterMesh/Left")
viewport_right = NodePath("../CharacterMesh/Right")
grid_building = NodePath("../Buildings")
grid_body = NodePath("../Bodies")
character = NodePath("../CharacterMesh/Front/CharacterBody2D")
mesh_instance = NodePath("../CharacterMesh")
camera = NodePath("../Camera3D")

[node name="CharacterMesh" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.84582, 16.7524, 5.42048)
material_override = SubResource("StandardMaterial3D_7mycd")
mesh = SubResource("QuadMesh_h2yge")

[node name="Front" type="SubViewport" parent="CharacterMesh"]
process_mode = 1
script = ExtResource("4_1bvp3")

[node name="CharacterBody2D" type="CharacterBody2D" parent="CharacterMesh/Front"]
collision_layer = 2
script = SubResource("GDScript_h2yge")

[node name="CollisionShape2D" type="CollisionShape2D" parent="CharacterMesh/Front/CharacterBody2D"]
shape = SubResource("RectangleShape2D_h2yge")

[node name="Back" type="SubViewport" parent="CharacterMesh"]
script = ExtResource("4_1bvp3")
direction = 1

[node name="Left" type="SubViewport" parent="CharacterMesh"]
script = ExtResource("4_1bvp3")
direction = 2

[node name="Right" type="SubViewport" parent="CharacterMesh"]
script = ExtResource("4_1bvp3")
direction = 3

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
mesh = SubResource("QuadMesh_1bvp3")
